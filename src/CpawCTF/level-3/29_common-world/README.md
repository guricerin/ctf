### RSA暗号 （『詳解セキュリティコンテスト』p.301より）

- ``p, q`` : 素数
- ``N`` : ``p``と``q``の積
- ``φ(N)`` : ``(p-1) * (q-1)``
  - [1..N]までのうち、``N``と互いに素な整数の個数
- ``e`` : ``φ(N)``と互いに素な整数
- ``(e, N)`` : 公開鍵
- ``d`` : 秘密鍵
  - ``e * d = 1 (mod φ(N))``となるようにする
- ``m`` : 平文
- ``c`` : 暗号文
- ``c = m ^ e (mod N)`` : 平文``m``を暗号化
- ``m = c ^ d (mod N)`` : 暗号文``c``を復号

### 解答

数式処理ライブラリの``sympy``をインストール。  

```bash
pip install sympy
```

```python
import sympy
N = 236934049743116267137999082243372631809789567482083918717832642810097363305512293474568071369055296264199854438630820352634325357252399203160052660683745421710174826323192475870497319105418435646820494864987787286941817224659073497212768480618387152477878449603008187097148599534206055318807657902493850180695091646575878916531742076951110529004783428260456713315007812112632429296257313525506207087475539303737022587194108436132757979273391594299137176227924904126161234005321583720836733205639052615538054399452669637400105028428545751844036229657412844469034970807562336527158965779903175305550570647732255961850364080642984562893392375273054434538280546913977098212083374336482279710348958536764229803743404325258229707314844255917497531735251105389366176228741806064378293682890877558325834873371615135474627913981994123692172918524625407966731238257519603614744577
ps = sympy.factorint(N)
```

巨大な整数の素因数分解なのにふつーに早い（``YAFU``ってツールだと1時間経っても終わらなかったのに）。  

これで``p``と``q``がわかり、``(p-1) * (q-1)``で``φ(N)``を取得。  

``e * d = 1 (mod φ(N))``を``d = 1/e (mod φ(N))``に式変形。これで``d``がわかる。  

``c``と``N``は既知なので必要な材料は揃った。``m = c ^ d (mod N)``を解いて終了。  
ヒントは使用せず。たぶん別の解答方法がある。  

- 参考
  - [『詳解セキュリティコンテスト』](https://book.mynavi.jp/ec/products/detail/id=122750)
  - [Welcome to SymPy’s documentation!](https://docs.sympy.org/latest/index.html#)
